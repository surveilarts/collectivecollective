<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sea Green Bouncing Orbs</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script>
      // Component that gives an orb a random velocity and makes it bounce off set boundaries.
      AFRAME.registerComponent('bounce-orb', {
        schema: {
          speed: { type: 'number', default: 1 }
        },
        init: function () {
          // Initialize a random velocity vector.
          this.velocity = new THREE.Vector3(
            (Math.random() * 2 - 1) * this.data.speed,
            (Math.random() * 2 - 1) * this.data.speed,
            (Math.random() * 2 - 1) * this.data.speed
          );
          // Define boundaries for a room of size 10 x 10 horizontally and 3 units high.
          this.boundaries = {
            xMin: -5, xMax: 5,
            yMin: 0.5, yMax: 3,  // Keeping orbs above the floor (y=0) and below the ceiling (y=3)
            zMin: -5, zMax: 5
          };
        },
        tick: function (time, delta) {
          // Update position based on velocity.
          delta = delta / 1000; // Convert delta to seconds.
          let pos = this.el.object3D.position;
          pos.addScaledVector(this.velocity, delta);

          // Check x-axis boundaries.
          if (pos.x <= this.boundaries.xMin || pos.x >= this.boundaries.xMax) {
            this.velocity.x = -this.velocity.x;
            pos.x = THREE.Math.clamp(pos.x, this.boundaries.xMin, this.boundaries.xMax);
          }
          // Check y-axis boundaries.
          if (pos.y <= this.boundaries.yMin || pos.y >= this.boundaries.yMax) {
            this.velocity.y = -this.velocity.y;
            pos.y = THREE.Math.clamp(pos.y, this.boundaries.yMin, this.boundaries.yMax);
          }
          // Check z-axis boundaries.
          if (pos.z <= this.boundaries.zMin || pos.z >= this.boundaries.zMax) {
            this.velocity.z = -this.velocity.z;
            pos.z = THREE.Math.clamp(pos.z, this.boundaries.zMin, this.boundaries.zMax);
          }
        }
      });

      // Component that spawns multiple bounce orbs inside the scene.
      AFRAME.registerComponent('spawn-bounce-orbs', {
        schema: {
          count: { type: 'int', default: 15 }
        },
        init: function () {
          const sceneEl = this.el;
          for (let i = 0; i < this.data.count; i++) {
            const orb = document.createElement('a-sphere');
            // Set a small radius for each orb.
            orb.setAttribute('radius', 0.2);
            // Sea green color.
            orb.setAttribute('color', '#2E8B57');
            // Position the orb randomly inside the room (a bit inset from the boundaries).
            const x = (Math.random() * 9) - 4.5;
            const y = (Math.random() * 2.5) + 0.5;
            const z = (Math.random() * 9) - 4.5;
            orb.setAttribute('position', { x: x, y: y, z: z });
            // Attach the bounce-orb behavior.
            orb.setAttribute('bounce-orb', '');
            sceneEl.appendChild(orb);
          }
        }
      });
    </script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <a-scene spawn-bounce-orbs>
      <!-- Lighting setup -->
      <a-entity light="type: ambient; intensity: 0.5" color="#ffffff"></a-entity>
      <a-entity light="type: directional; intensity: 0.6" position="0 5 5"></a-entity>
      
      <!-- Floor -->
      <a-plane position="0 0 0" rotation="-90 0 0" width="10" height="10" color="#CCCCCC"></a-plane>
      
      <!-- Ceiling -->
      <a-plane position="0 3 0" rotation="90 0 0" width="10" height="10" color="#CCCCCC"></a-plane>
      
      <!-- Walls -->
      <!-- Left Wall -->
      <a-plane position="-5 1.5 0" rotation="0 90 0" width="10" height="3" color="#66CDAA"></a-plane>
      <!-- Right Wall -->
      <a-plane position="5 1.5 0" rotation="0 -90 0" width="10" height="3" color="#66CDAA"></a-plane>
      <!-- Front Wall -->
      <a-plane position="0 1.5 -5" rotation="0 0 0" width="10" height="3" color="#66CDAA"></a-plane>
      <!-- Back Wall -->
      <a-plane position="0 1.5 5" rotation="0 180 0" width="10" height="3" color="#66CDAA"></a-plane>
      
      <!-- Optional sky for ambiance -->
      <a-sky color="#333333"></a-sky>
    </a-scene>
  </body>
</html>
